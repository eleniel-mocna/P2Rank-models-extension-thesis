%%% The main file. It contains definitions of basic parameters and includes all other parts.

%% Settings for single-side (simplex) printing
% Margins: left 40mm, right 25mm, top and bottom 25mm
% (but beware, LaTeX adds 1in implicitly)
\documentclass[12pt,a4paper]{report}
\setlength\textwidth{145mm}
\setlength\textheight{247mm}
\setlength\oddsidemargin{15mm}
\setlength\evensidemargin{15mm}
\setlength\topmargin{0mm}
\setlength\headsep{0mm}
\setlength\headheight{0mm}
% \openright makes the following text appear on a right-hand page
\let\openright=\clearpage

%% Settings for two-sided (duplex) printing
% \documentclass[12pt,a4paper,twoside,openright]{report}
% \setlength\textwidth{145mm}
% \setlength\textheight{247mm}
% \setlength\oddsidemargin{14.2mm}
% \setlength\evensidemargin{0mm}
% \setlength\topmargin{0mm}
% \setlength\headsep{0mm}
% \setlength\headheight{0mm}
% \let\openright=\cleardoublepage

%% Generate PDF/A-2u
\usepackage[a-2u]{pdfx}

%% Character encoding: usually latin2, cp1250 or utf8:
\usepackage[utf8]{inputenc}

%% Prefer Latin Modern fonts
\usepackage{lmodern}

%% Further useful packages (included in most LaTeX distributions)
\usepackage{amsmath}        % extensions for typesetting of math
\usepackage{amsfonts}       % math fonts
\usepackage{amsthm}         % theorems, definitions, etc.
\usepackage{bbding}         % various symbols (squares, asterisks, scissors, ...)
\usepackage{bm}             % boldface symbols (\bm)
\usepackage{graphicx}       % embedding of pictures
\usepackage{fancyvrb}       % improved verbatim environment
\usepackage{natbib}         % citation style AUTHOR (YEAR), or AUTHOR [NUMBER]
\usepackage[nottoc]{tocbibind} % makes sure that bibliography and the lists
			    % of figures/tables are included in the table
			    % of contents
\usepackage{dcolumn}        % improved alignment of table columns
\usepackage{booktabs}       % improved horizontal lines in tables
\usepackage{paralist}       % improved enumerate and itemize
\usepackage{xcolor}         % typesetting in color
\usepackage{hyperref}
\usepackage{listings}
\usepackage{color}
\usepackage{dirtytalk}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[printonlyused,withpage]{acronym}

\DeclareRobustCommand{\bbone}{\text{\usefont{U}{bbold}{m}{n}1}}

\DeclareMathOperator{\EX}{\mathbb{E}}% expected value

\newcommand{\distras}[1]{%
  \savebox{\mybox}{\hbox{\kern3pt$\scriptstyle#1$\kern3pt}}%
  \savebox{\mysim}{\hbox{$\sim$}}%
  \mathbin{\overset{#1}{\kern\z@\resizebox{\wd\mybox}{\ht\mysim}{$\sim$}}}%
}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}
%%% Basic information on the thesis

% Thesis title in English (exactly as in the formal assignment)
\def\ThesisTitle{Using convolutional neural networks to detect protein-ligand binding sites}

% Author of the thesis
\def\ThesisAuthor{Samuel Soukup}

% Year when the thesis is submitted
\def\YearSubmitted{2024}

% Name of the department or institute, where the work was officially assigned
% (according to the Organizational Structure of MFF UK in English,
% or a full name of a department outside MFF)
\def\Department{Department of Software Engineering}

% Is it a department (katedra), or an institute (ústav)?
\def\DeptType{Department}

% Thesis supervisor: name, surname and titles
\def\Supervisor{doc. RNDr. David Hoksza, Ph.D.}

% Supervisor's department (again according to Organizational structure of MFF)
\def\SupervisorsDepartment{Department of Software Engineering}

% Study programme and specialization
\def\StudyProgramme{Computer Science (B0613A140006)}
\def\StudyBranch{Artificial Intelligence Bc. (NIUI19B)}

% An optional dedication: you can thank whomever you wish (your supervisor,
% consultant, a person who lent the software, etc.)
\def\Dedication{
Computational resources were provided by the e-INFRA CZ project (ID:90254),
supported by the Ministry of Education, Youth and Sports of the Czech Republic.
}

% Abstract (recommended length around 80-200 words; this is not a copy of your thesis assignment!)
\def\Abstract{%
Using convolutional neural networks (CNN) for high dimensional data such as images has shown some promising results, but it has issues with features without spatial correlation. I test a streamlined version of the REFINED (REpresentation of Features as Images with NEighborhood Dependencies) model and compare its performance on a ligand binding site detection dataset. I explore the correlation between the CNN performance and the technique used to transform input vectors into images. I find no significant evidence supporting that REFINED has better predictive power than state-of-the-art approaches or CNNs using matrices with randomly assigned feature positions.
}

\def\AbstractCS{%
Použití konvolučních neuronových sítí (CNN) pro vysokorozměrná data, jako jsou obrázky, ukázalo některé slibné výsledky, ale má problémy s featurami bez prostorové korelace. V této práci jsem otestoval zjednodušenou verzi modelu REFINED (REpresentation of Features as Images with Neighborhood Dependencies) a porovnával její výkon na datasetu detekce vazebného místa ligandu. Dále jsem se pokusil najít korelaci mezi prediktivní silou CNN a použitou metodou pro transformaci vstupních vektorů do obrázků. Nenašel jsem žádný výsledek, podporující hypotézu, že by REFINED mělo lepší prediktivní sílu než nejmodernější přístupy nebo jenom CNN využívající matice s náhodně přiřazenými pozicemi prvků.
}
% 3 to 5 keywords (recommended), each enclosed in curly braces
\def\Keywords{%
{protein} {bioinformatics} {machine learning} {cnn}
}
\def\ThesisKeywordsCS{%
{protein} {bioinformatika} {strojové učení} {cnn}
}

%% The hyperref package for clickable links in PDF and also for storing
%% metadata to PDF (including the table of contents).
%% Most settings are pre-set by the pdfx package.
\hypersetup{unicode}
\hypersetup{breaklinks=true}

% Definitions of macros (see description inside)
\include{macros}


% Title page and various mandatory informational pages
\begin{document}

\include{title}

%%% A page with automatically generated table of contents of the bachelor thesis

\tableofcontents

%%% Each chapter is kept in a separate file
\include{preface}
\include{chap01}
% \include{chap02}
\include{chap03}
\include{chap04}
\include{chap05}
\include{chap06}

\include{epilog}

%%% Bibliography
\include{bibliography}

%%% Figures used in the thesis (consider if this is needed)
\listoffigures

%%% Tables used in the thesis (consider if this is needed)
%%% In mathematical theses, it could be better to move the list of tables to the beginning of the thesis.
% \listoftables

%%% Abbreviations used in the thesis, if any, including their explanation
%%% In mathematical theses, it could be better to move the list of abbreviations to the beginning of the thesis.
\chapwithtoc{List of Abbreviations}
\begin{acronym}
    \acro{CNN}{Convolutional Neural Network. A neural network with convolutional layers. A good description of convolutional layers is \href{https://www.tensorflow.org/api_docs/python/tf/nn/conv2d}{in the TensorFlow documentation}.}
    \acro{SAS}{Solvent accessible surface. Area on the surface of the protein. SAS points then represent local spherical 3D neighborhoods that are centered on them. At the same time, they can be seen as potential locations of contact atoms of potential ligands. For more info on SAS points, see \textit{Materials and methods} of \cite{P2RANK}. For a closer description of SAS, see the \href{https://en.wikipedia.org/wiki/Accessible_surface_area}{relevant Wikipedia page}.}
    \acro{GEA}{Genetic evolutionary algorithm. An optimization algorithm simulating Darwinian evolution. In work, the permutation encoding was used as described \href{https://martinpilat.com/en/nature-inspired-algorithms/evolutionary-algorithms-continuous-and-combinatorial-optimization}{by Martin Pilát.}}
    \acro{HCA}{Hill Climbing Algorithm. Shortly describe in the relevant footnote: ~\ref{hca_description}, or the relevant \href{https://en.wikipedia.org/wiki/Hill_climbing}{Wikipedia page}.}
    \acro{RFC}{Random Forest Classifier. A meta classifier made by averaging between multiple decision tree classifiers. Well described on the relevant \href{https://en.wikipedia.org/wiki/Random_forest}{Wikipedia page}.}
    \acro{LBS}{Ligand Binding Site, see ~\ref{LBS}.}
\end{acronym}

%%% Attachments to the bachelor thesis, if any. Each attachment must be
%%% referred to at least once from the text of the thesis. Attachments
%%% are numbered.
%%%
%%% The printed version should preferably contain attachments, which can be
%%% read (additional tables and charts, supplementary text, examples of
%%% program output, etc.). The electronic version is more suited for attachments
%%% which will likely be used in an electronic form rather than read (program
%%% source code, data files, interactive charts, etc.). Electronic attachments
%%% should be uploaded to SIS and optionally also included in the thesis on a~CD/DVD.
%%% Allowed file formats are specified in provision of the rector no. 72/2017.
\appendix
\chapter{Attachments}

\section{Feature list}
\label{feature_list}
This is the list of features used in the models:
\begin{lstlisting}
['chem.hydrophobic', 'chem.hydrophilic', 'chem.hydrophatyIndex',
'chem.aliphatic', 'chem.aromatic', 'chem.sulfur', 'chem.hydroxyl',
'chem.basic', 'chem.acidic', 'chem.amide', 'chem.posCharge',
'chem.negCharge', 'chem.hBondDonor', 'chem.hBondAcceptor',
'chem.hBondDonorAcceptor', 'chem.polar', 'chem.ionizable', 'chem.atoms',
'chem.atomDensity', 'chem.atomC', 'chem.atomO', 'chem.atomN',
'chem.hDonorAtoms', 'chem.hAcceptorAtoms', 'volsite.vsAromatic',
'volsite.vsCation', 'volsite.vsAnion', 'volsite.vsHydrophobic',
'volsite.vsAcceptor', 'volsite.vsDonor', 'protrusion.protrusion',
'bfactor.bfactor', 'xyz.x', 'xyz.y', 'xyz.z', 'atom_table.apRawValids',
'atom_table.apRawInvalids', 'atom_table.atomicHydrophobicity']
\end{lstlisting}
The label is column is named \texttt{'@@class@@'}.

These features are the same as described in \cite{P2RANK}, Additional File, Table 4.

\openright
\end{document}
